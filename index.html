<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="main.css" type="text/css" />
        <script>
            var isX = true
            var gameOver = false
            var isEditable = true
            var twoPlayer = true
            function addXorO(event) {
                cellClicked = event.srcElement.id
                if (!hasBeenClicked(cellClicked)) {
                    html = document.getElementById(cellClicked).innerHTML
                    if (isEditable) {
                       if (isX) {
                            document.getElementById(cellClicked).innerHTML = "X"
                            document.getElementById("turn").innerHTML = "O's turn!"
                        } else {
                            document.getElementById(cellClicked).innerHTML = "O"
                            document.getElementById("turn").innerHTML = "X's turn!"
                        }
                        if (!twoPlayer) {
                            computerTurn()
                        }
                        gameOver = checkGameOver()
                        if (gameOver) {
                            if (isX) {
                              alert("X's won!")  
                            } else {
                                alert("O's won!")
                            }
                            isEditable = !isEditable
                        }
                        if (twoPlayer) {
                           isX = !isX 
                        }
                    }
                    
                }
                
            }
            
            function toggleTwoPlayer() {
                twoPlayer = !twoPlayer
                if (twoPlayer) {
                    document.getElementById("description").innerHTML = "Two Player Game"
                } else {
                    document.getElementById("description").innerHTML = "One Player Game"
                }
            }
            
            function computerTurn() {
                computerDone = false
                console.log('computer turn')
                values = []
                for (i = 1; i < 10; i++) {
                    html = document.getElementById(i.toString()).innerHTML
                    values.push(html)
                }
                while (!computerDone) {
                    var random = Math.floor(Math.random() * 9)
                    console.log('random', random)
                    if (values[random] === "") {
                        document.getElementById(random).innerHTML = "O"
                        computerDone = true
                    }
                }
            }
            
            function hasBeenClicked(cell) {
                if (document.getElementById(cell).innerHTML !== "") {
                    return true
                } else {
                    return false
                }
            }
            
            function checkGameOver() {
                values = []
                for (i = 1; i < 10; i++) {
                    html = document.getElementById(i.toString()).innerHTML
                    values.push(html)
                }
                if (values[0] === values[1] && values[0] === values[2]) {
                    if(values[0] !== "") {
                        document.getElementById("1").style.backgroundColor = "green"
                        document.getElementById("2").style.backgroundColor = "green"
                        document.getElementById("3").style.backgroundColor = "green"
                      return true  
                    }
                } else if (values[0] === values[3] && values[0] === values[6]) {
                    if(values[0] !== "") {
                        document.getElementById("1").style.backgroundColor = "green"
                        document.getElementById("4").style.backgroundColor = "green"
                        document.getElementById("7").style.backgroundColor = "green"
                      return true  
                    }
                } else if (values[2] === values[5] && values[2] === values[8]) {
                    if(values[2] !== "") {
                        document.getElementById("3").style.backgroundColor = "green"
                        document.getElementById("6").style.backgroundColor = "green"
                        document.getElementById("9").style.backgroundColor = "green"
                      return true  
                    }
                } else if (values[6] === values[7] && values[6] === values[8]) {
                    if(values[6] !== "") {
                        document.getElementById("7").style.backgroundColor = "green"
                        document.getElementById("8").style.backgroundColor = "green"
                        document.getElementById("9").style.backgroundColor = "green"
                      return true  
                    }
                } else if (values[3] === values[4] && values[3] === values[5]) {
                    if(values[3] !== "") {
                        document.getElementById("4").style.backgroundColor = "green"
                        document.getElementById("5").style.backgroundColor = "green"
                        document.getElementById("6").style.backgroundColor = "green"
                      return true  
                    }
                } else if (values[1] === values[4] && values[1] === values[7]) {
                    if(values[1] !== "") {
                        document.getElementById("2").style.backgroundColor = "green"
                        document.getElementById("5").style.backgroundColor = "green"
                        document.getElementById("8").style.backgroundColor = "green"
                      return true  
                    }
                } else if (values[0] === values[4] && values[0] === values[8]) {
                    if(values[0] !== "") {
                        document.getElementById("1").style.backgroundColor = "green"
                        document.getElementById("5").style.backgroundColor = "green"
                        document.getElementById("9").style.backgroundColor = "green"
                      return true  
                    }
                } else if (values[2] === values[4] && values[2] === values[6]) {
                    if(values[2] !== "") {
                        document.getElementById("3").style.backgroundColor = "green"
                        document.getElementById("5").style.backgroundColor = "green"
                        document.getElementById("7").style.backgroundColor = "green"
                      return true  
                    }
                } else if (values.filter(el => el === "").length === 0) {
                    document.getElementById("turn").innerHTML = "It's a draw! Click 'New Game' to play again!"
                    document.getElementById("1").style.backgroundColor = "red"
                    document.getElementById("2").style.backgroundColor = "red"
                    document.getElementById("3").style.backgroundColor = "red"
                    document.getElementById("4").style.backgroundColor = "red"
                    document.getElementById("5").style.backgroundColor = "red"
                    document.getElementById("6").style.backgroundColor = "red"
                    document.getElementById("7").style.backgroundColor = "red"
                    document.getElementById("8").style.backgroundColor = "red"
                    document.getElementById("9").style.backgroundColor = "red"
                    alert("CAT!  It's a draw!")
                    return false
                } else {
                    return false
                }
            }
        </script>
    </head>
    <body>
        <div class="center">
            <div style="display:inline-block; margin-right: 40px; margin-top:30px;" id="onePlayer">
                <button onClick="toggleTwoPlayer()">One Player</button> 
            </div>
            <div style="display:inline-block; margin-right: 40px; margin-top:30px;" id="twoPlayers">
                <button onClick="toggleTwoPlayer()">Two Player</button> 
            </div>
            <div style="display:inline-block; margin-left:110px;">
               <h1>Tic Tac Toe</h1> 
            </div>
            <div style="display:inline-block; margin-left: 40px; margin-top:30px;">
                <button onClick="window.location.reload()">New Game</button> 
            </div>
        </div>
        <div class="center" id="description">
            <h3>Two Player Game: Click to Play!</h3>
        </div>
        <table style="width:600px; height:500px;">
            <tr>
                <td id="1" onClick="addXorO(event)"></td>
                <td id="2" onClick="addXorO(event)"></td>
                <td id="3" onClick="addXorO(event)"></td>
            </tr>
            <tr>
                <td id="4" onClick="addXorO(event)"></td>
                <td id="5" onClick="addXorO(event)"></td>
                <td id="6" onClick="addXorO(event)"></td>
            </tr>
            <tr>
                <td id="7" onClick="addXorO(event)"></td>
                <td id="8" onClick="addXorO(event)"></td>
                <td id="9" onClick="addXorO(event)"></td>
            </tr>
        </table>
        <div class="center" style="padding-top:10px;" id="turn">
            X's turn!
        </div>
    </body>
</html>